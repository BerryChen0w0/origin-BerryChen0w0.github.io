---
layout: post
title: "R1CS和QAP的转化"
date: 2024-04-11
---

# R1CS和QAP的转化

> 文章更像是自己想法的记录，旁人读起来可以不够顺畅，还请见谅。
> 文中内容是个人的理解，可能在部分地方有错误，请读者注意。也请读者指出我的错误，帮助我理解相关知识，在此提前感谢您！
> 联系我：berrychen0w0@163.com

在零知识证明中，计算模型一般是电路，也就是把问题抽象成一个电路表示（关于为什么用电路表示，可以另写一篇来讲讲【偏计算理论的东西 那一篇里面讲吧）【电路还有算术电路和布尔电路的分别，不过这两者是等价的，有转化方法，PAZK书上有提到】。常用的计算模型（电路）有三种。一种是普通的算术电路，它的数学化表示有R1CS和QAP两种，这两种表示本质上是一样的，它们可以轻松地相互转化。第二种是分层电路，它是一种结构很好的算术电路。GKR协议可以是使用分层电路的一个例子【GKR见PAZK书4.6节】。第三种可以称为PLONKish电路，是PLONK协议及其类似协议（例如Halo2等）使用的电路表示方法，它比前两种电路更加灵活，除了加法门和乘法门之外，还可以包括其他的自定义门【我还不太懂，学会了再写一篇文章讲hhh】。

除了PLONK类协议之外，大部分的zkSNARK协议【又是一个专有名词，应该解释一下】都是基于普通算术电路的【应该是吧？】。而要把零知识证明协议应用到电路上，首先又需要把算术电路数学化表示。普通算术电路的数学表示，一般使用R1CS或QAP。可以认为它们提供了两个不同的电路数学化表示的视角，但是这两者本质上是等价的，两者之间的转化也很简单【不过对初学者而言还是有很多细节要搞清楚，我自己就常常绕进去hhh】。本文讨论对普通算术电路的这两种数学表示，及其相互转化。

> 对R1CS和QAP的理解，我接触到的有两种：一种是wlg学长说的，R1CS是矩阵表示，QAP是多项式表示，即我前文说到的两种视角。另一种是Vitalik的文章【https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649 】里说的，电路-->R1CS-->QAP这样的数学化表示路径，即R1CS是把电路转化为QAP这种数学表示的中介。中文互联网上大部分讲R1CS和QAP的文章都是基于Vitalik的文章，甚至直接翻译Vitalik的文章的，因此似乎第二种理解更普遍些。
> 我个人的观点，目前倾向于第二种。因为我现在知道的协议都是基于QAP做的，还不知道有什么协议是基于R1CS做的。如果有协议是直接基于R1CS来做，那么似乎第一种理解就更好些。我认为第一种是把R1CS和QAP放在同等地位（即电路转化为R1CS或QAP都行），而第二种是把R1CS视为QAP的前置表示（即电路最终要转化为QAP才行）。

## 算术电路
【这里说？还是其他文章里说？似乎这里说一下比较好】

## R1CS
【在哪里提出？】

## QAP
在Pinocchio论文中提出。【抄一下Pinocchio里的定义吧】

## R1CS转QAP
草稿纸！

## R1CS和QAP的关系 相关材料
https://aping-dev.com/index.php/archives/425/#title-14
https://crypto.stackexchange.com/questions/88466/construction-of-r1cs-vs-qap